(function(e){var k,f,o=1,g,l=this,m,i=l.postMessage,h,d;if(!i)var j=[],n,p=function(){n=setInterval(function(){if(0<j.length)h.location=d.replace(/#.*$/,"")+"#"+ +new Date+o++ +"&"+j.shift()},1E3)};e.postMessage=function(c,a,b){if(d=a)if(c="string"===typeof c?c:e.param(c),h=b||parent,i)h.postMessage(c,d.replace(/([^:]+:\/\/[^\/]+).*/,"$1"));else if(d){c=c.match(/.{1,1000}/g);a=0;for(b="";b=c[a++];)j.push(b+"&;;pm_part="+a+","+c.length);"undefined"===typeof n&&p(h,d)}};e.receiveMessage=m=function(c,
a,b){b=a&&e.isWindow(a)?a:b&&e.isWindow(b)?b:l;console.log("attaching to ",e("title",b.document).text());if(i)if(c&&(g&&m(),g=function(b){if("string"===typeof a&&b.origin!==a||e.isFunction(a)&&!1===a(b.origin))return!1;c(b)}),b.addEventListener)b[c?"addEventListener":"removeEventListener"]("message",g,!1);else b[c?"attachEvent":"detachEvent"]("onmessage",g);else{for(var d in interval_ids)interval_ids[d]===b&&clearInterval(d)&&(interval_ids[d]=null);c&&(delay="number"===typeof a?a:"number"===typeof delay?
delay:100,d=setInterval(function(){var a=b.document.location.hash,d=/^#?\d+&/;if(a!==k&&d.test(a)&&(k=a,a=a.match(/(.*)&;;pm_part=(\d+),(\d+)/),f+=a[1].replace(d,""),a[2]===a[3]))c({data:f}),f="",b.document.location.hash=""},100),interval_ids[d]=b)}}})(jQuery);
